<html>
<title>Parallel Processing</title>
</head>
<body>
<p>
<a href="https://github.com/laforge49/JActor2#readme">JActor2</a> &gt; <a href="../../index.html">Docs</a> &gt; <a href="../index.html">Tutorials</a> &gt; <a href="index.html">Core</a> &gt; Parallel
</p>
<h1>Parallel - Parallel Processing</h1>
<p>
Parallel processing can be as simple as sending multiple requests to multiple reactors.
In the <a href="java7/Parallel.java">Parallel</a> program,
a facility is created with 10 threads and
10 sleep requests of 100 milliseconds each are sent to 10 different 
<a href="../../api/coreMt/org/agilewiki/jactor2/core/impl/Delay.html">Delay</a>
blades,
each running in a different reactor. And the total processing time is just over 100 milliseconds.
</p>
<pre>
import org.agilewiki.jactor2.core.blades.NonBlockingBladeBase;
import org.agilewiki.jactor2.core.impl.Delay;
import org.agilewiki.jactor2.core.impl.Plant;
import org.agilewiki.jactor2.core.requests.AOp;
import org.agilewiki.jactor2.core.requests.AsyncResponseProcessor;
import org.agilewiki.jactor2.core.requests.impl.AsyncRequestImpl;

public class Parallel extends NonBlockingBladeBase {
    private final long count;
    
    public Parallel(final long _count) throws Exception {
        count = _count;
    }
    
    public AOp&lt;Void&gt; runAOp() {
        return new AOp&lt;Void&gt;("run", getReactor()) {
            protected void processAsyncOperation(final AsyncRequestImpl _asyncRequestImpl, 
					final AsyncResponseProcessor&lt;Void&gt; _asyncResponseProcessor) throws Exception {
				final AsyncResponseProcessor&lt;Void&gt; sleepResponseProcessor = 
						new AsyncResponseProcessor&lt;Void&gt;() {
					@Override
					public void processAsyncResponse(final Void _response) throws Exception {
						if (_asyncRequestImpl.getPendingResponseCount() == 0)
							_asyncResponseProcessor.processAsyncResponse(null);
					}
				};
            
                long j = 0;
                while(j &lt; count) {
                    j++;
                    Delay delay = new Delay();
                    _asyncRequestImpl.send(delay.sleepSOp(100), sleepResponseProcessor);
                }
            }
        };
    }
    
    public static void main(final String[] _args) throws Exception {
        final long count = 10L;
        new Plant(10);
        try {
            Parallel parallel = new Parallel(count);
            AOp&lt;Void&gt; runAOp = parallel.runAOp();
            final long before = System.currentTimeMillis();
            runAOp.call();
            final long after = System.currentTimeMillis();
            final long duration = after - before;
            System.out.println("Parallel Test with 10 Threads");
            System.out.println("count: " + count);
            System.out.println("sleep duration: 100 milliseconds");
            System.out.println("total time: " + duration + " milliseconds");
        } finally {
            Plant.close();
        }
    }
}

Output:

Parallel Test with 10 Threads
count: 10
sleep duration: 100 milliseconds
total time: 102 milliseconds
</pre>
</body>
</html>
