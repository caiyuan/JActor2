<html>
<body>
<p>
<a href="https://github.com/laforge49/JActor2#readme">JActor2</a> &gt; <a href="../../index.html">Docs</a> &gt; <a href="../index.html">Tutorials</a> &gt; <a href="index.html">Core</a> &gt; UltimateAnswer
</p>
<h1>UltimateAnswer - send</h1>
<p>
How do blades with different reactors exchange messages? 
The call method does not apply because the source of the request is on a pool thread.
The local method does not apply either because the blades do not have a common reactor.
The answer is an asynchronous exchange using the send method with an instance of
AsyncResponseProcessor
<a href="../../api/org/agilewiki/jactor2/core/messages/AsyncResponseProcessor.html">AsyncResponseProcessor</a>
as the callback.
</p>
<p>
The <a href="UltimateAnswer.java">UltimateAnswer</a> blade sends a println request to Printer.
And the Printer blade is in a different reactor.
</p>
<pre>
import org.agilewiki.jactor2.core.blades.NonBlockingBladeBase;
import org.agilewiki.jactor2.core.blades.misc.Printer;
import org.agilewiki.jactor2.core.facilities.BasicPlant;
import org.agilewiki.jactor2.core.facilities.Plant;
import org.agilewiki.jactor2.core.messages.AsyncRequest;
import org.agilewiki.jactor2.core.messages.AsyncResponseProcessor;
import org.agilewiki.jactor2.core.reactors.NonBlockingReactor;

public class UltimateAnswer extends NonBlockingBladeBase {

    public UltimateAnswer(final NonBlockingReactor _reactor) throws Exception {
        initialize(_reactor);
    }
    
    public AsyncRequest&lt;Void&gt; printAnswerAReq() {
        return new AsyncBladeRequest&lt;Void&gt;() {
            final AsyncResponseProcessor&lt;Void&gt; dis = this;

            @Override
            public void processAsyncRequest() throws Exception {
                AsyncRequest<Void> printRequest = Printer.printlnAReq("*** 42 ***");
                send(printRequest, dis);
            }
        };
    }
    
    public static void main(final String[] _args) throws Exception {
        BasicPlant plant = new Plant();
        try {
            UltimateAnswer ultimateAnswer = new UltimateAnswer(new NonBlockingReactor(plant));
            AsyncRequest&lt;Void&gt; printAnswerAReq = ultimateAnswer.printAnswerAReq();
            printAnswerAReq.call();
        } finally {
            plant.close();
        }
    }
}
</pre>
<table style="border: 2px solid;" bgcolor="lightgray">
<tr>
<th style="padding: 5px;" bgcolor="lightyellow">
Main Thread
</th>
<th>
&nbsp;
</th>
<th style="padding: 5px;" bgcolor="lightyellow">
Non-blocking Reactor
</th>
<th>
&nbsp;
</th>
<th style="padding: 5px;" bgcolor="lightyellow">
BlockingReactor
</th>
</tr>
<tr>
<th style="padding: 5px;" bgcolor="lightyellow">
UltimateAnswer
</th>
<th>
&nbsp;
</th>
<th style="padding: 5px;" bgcolor="lightyellow">
UltimateAnswer
</th>
<th>
&nbsp;
</th>
<th style="padding: 5px;" bgcolor="lightyellow">
Printer
</th>
</tr>
<tr>
<td style="border: 1px solid; padding: 5px;" bgcolor="lightyellow">
call
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td style="border: 1px solid; padding: 5px;" bgcolor="lightyellow">
wait
</td>
<td style="padding: 5px; text-align: center;">
---printAnswer-->
</td>
<td style="border: 1px solid; padding: 5px;" bgcolor="lightyellow">
allocate thread
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
<td style="border: 1px solid; padding: 5px;" bgcolor="lightyellow">
send
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
<td style="padding: 5px; text-align: center;">
---(thread, println)-->
</td>
<td style="border: 1px solid; padding: 5px;" bgcolor="lightyellow">
println "*** 42 ***"
</td>
</tr>
<tr>
<td style="border: 1px solid; padding: 5px;" bgcolor="lightyellow">
wakeup
</td>
<td style="padding: 5px; text-align: center;">
<--response: null--
</td>
<td style="border: 1px solid; padding: 5px;" bgcolor="lightyellow">
release thread
</td>
<td style="padding: 5px; text-align: center;">
<--(thread, response: null)---
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td style="border: 1px solid; padding: 5px;" bgcolor="lightyellow">
close
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
<td>
&nbsp;
</td>
</tr>
</table>
<h3>
<a href="../../api/org/agilewiki/jactor2/core/messages/AsyncRequest.html#send-org.agilewiki.jactor2.core.messages.Request-org.agilewiki.jactor2.core.messages.AsyncResponseProcessor-">send</a>
</h3>
<pre>
    public AsyncRequest&lt;Void&gt; printAnswerAReq() {
        return new AsyncBladeRequest&lt;Void&gt;() {
            final AsyncResponseProcessor&lt;Void&gt; dis = this;

            @Override
            public void processAsyncRequest() throws Exception {
                BasicPlant plant = getReactor().getPlant();
                AsyncRequest<Void> printRequest = Printer.printlnAReq(plant, "*** 42 ***");
                send(printRequest, dis);
            }
        };
    }
</pre>
<p>
The AsyncRequest.send method takes two arguments, a request and an AsyncResponseProcessor.
And there is no return value. Rather, the response is passed back via the AsyncResponseProcessor.
</p>
<p>
The use of the send method, which is mandated for exchanges between reactors, in turn requires the use
of an AsyncRequest.
</p>
</body>
</html>
